# Task Tracker & Kanban

This file maintains the persistent planning board for the React GTM Kit project. Update task status and notes in-place as work progresses; never delete a task. Append new tasks instead of replacing existing entries so the project history remains auditable.

**Status definitions**

- **Backlog** – Planned work that has not yet started.
- **In Progress** – Actively being delivered.
- **Review** – Awaiting peer review, testing, or verification.
- **Blocked** – Requires external input or prerequisite completion.
- **Done** – Finished and documented.

| ID                                                                                                                                                                                                | Task                                                                                                    | Status  | Notes (last updated: 2025-11-11)                                                                                                                                                                                                                                                                                                                                                                                                  |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------- | ------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| TK-001                                                                                                                                                                                            | Consolidate charter, scope, architecture, and governance into README for single-source documentation.   | Done    | Captured full project brief, requirements, and governance in README refresh.                                                                                                                                                                                                                                                                                                                                                      |
| TK-002                                                                                                                                                                                            | Freeze API surface and finalize design sign-off package (M0).                                           | Review  | 2025-11-06: Drafted API sign-off doc, ownership matrix, and decision log; awaiting architecture + DX approval.<br>Prep: reconfirm scope/non-goals in README with stakeholders;<br>Draft API signatures + lifecycle diagrams in `docs/design/api-signoff.md`;<br>Author governance/ownership matrix in `docs/governance/OWNERS.md`;<br>Record sign-off in `docs/design/DECISIONS.md`.                                              |
| TK-003                                                                                                                                                                                            | Implement core package alpha covering init/queue/flush, multi-container, teardown, and unit tests (M1). | Done    | 2025-11-11: Added coverage for custom host + default query param script injection to validate environment param handling; core init/queue/flush behavior now exercised under host overrides.<br>2025-11-12: Hardened queue/runtime push behavior by deduplicating only consent commands while allowing repeated non-consent events, with new tests ensuring duplicate pre-init pushes remain ordered; promoted milestone to Done. |
| TK-004                                                                                                                                                                                            | Build Consent Mode v2 API with comprehensive tests (M2).                                                | Done    | 2025-11-23: Added typed consent default/update command helpers for direct data layer pushes, broadened tests for helper output, and documented low-level usage in `docs/how-to/consent.md`.                                                                                                                                                                                                                                       |
| TK-005                                                                                                                                                                                            | Deliver SSR noscript helper and CSP nonce handling with E2E coverage (M3).                              | Done    | 2025-11-26: Hardened SSR CSP E2E to assert noscript data layer params + hidden iframe attrs and documented fallback alignment; CSP/nonces + docs now covered.                                                                                                                                                                                                                                                                     |
|                                                                                                                                                                                                   |
| TK-006                                                                                                                                                                                            | Ship React adapters (modern + legacy) with integration tests (M4).                                      | Backlog | Plan: create `packages/react-modern/` hook/provider handling StrictMode double mount;<br>Create `packages/react-legacy/` HOC for class components;<br>Add Testing Library integration tests for StrictMode behavior;<br>Update examples to include CRA/Vite sample using adapters.                                                                                                                                                |
| TK-007                                                                                                                                                                                            | Publish Next.js helpers and App Router E2E scenario (M5).                                               | Backlog | Plan: scaffold `packages/next/` with CSP nonce bridge, route listener, noscript export;<br>Build `examples/next-app/` exercising helpers across navigations;<br>Write Playwright E2E covering initial load + client transitions with dataLayer pushes.                                                                                                                                                                            |
| TK-008                                                                                                                                                                                            | Author task-based documentation and runnable examples (M6).                                             | Backlog | Plan: set up docs site (Docusaurus/VitePress) with landing, concepts, how-to pages;<br>Produce runnable examples: vanilla CSR, React SPA, Next App Router, consent integration;<br>Integrate examples into CI smoke tests via npm scripts.                                                                                                                                                                                        |
| TK-009                                                                                                                                                                                            | Complete hardening pass: coverage, size budgets, semantic-release wiring (M7).                          | Backlog | Plan: enforce coverage thresholds in Jest + CI;<br>Add bundle size check (≤3 kB gzip) via `size-limit`;<br>Configure GitHub Actions for lint/test/E2E/size + `semantic-release` pipeline;<br>Automate compatibility matrix (React versions, browsers) via scheduled workflow;<br>Prepare release notes template and dry-run publish.                                                                                              |
| TK-010                                                                                                                                                                                            | Maintain compatibility matrix validation pipeline and monthly React release review cadence.             | Done    |
| 2025-11-20: Added maintenance cadence doc + compatibility matrix, scheduled React release monitor workflow with baseline config, and documented support SLAs/triage labels in contributing guide. |
|                                                                                                                                                                                                   |
| TK-012                                                                                                                                                                                            | Enforce code quality gates across linting, formatting, and commits.                                     | Done    | 2025-11-07: Added shared ESLint/Prettier configs, Husky + lint-staged automation, commitlint checks, and contributor workflow doc covering formatting + commit rules.                                                                                                                                                                                                                                                             |
| TK-013                                                                                                                                                                                            | Complete privacy, security, and compliance review artifacts.                                            | Done    | 2025-11-07: Authored privacy guidance, security review summary, and risk log docs; captured open follow-ups (Dependabot, disclosure policy) and recorded clean `pnpm audit --prod` run.                                                                                                                                                                                                                                           |
| TK-014                                                                                                                                                                                            | Prepare 1.0 launch collateral and release checklist.                                                    | Done    | 2025-11-10: Added curated API reference (`docs/reference/api.md`), linked it in the docs nav, and refreshed README quickstart guidance for React and Next.js. Release checklist already lives under governance.                                                                                                                                                                                                                   |
| TK-015                                                                                                                                                                                            | Run architecture review and finalize RFCs for instrumentation and container strategy (M0).              | Done    | 2025-11-09: Approved lifecycle RFC (`docs/design/rfc-gtm-loader.md`), added sequence diagram under `docs/design/architecture/`, and logged Architecture/DX sign-off in `docs/design/DECISIONS.md`.                                                                                                                                                                                                                                |
| TK-016                                                                                                                                                                                            | Validate legal/compliance requirements with privacy counsel pre-M0.                                     | Done    | 2025-11-10: Added GDPR/CCPA/LGPD obligations, release sign-off checklist, and new risk entries; pending counsel confirmation captured in risk log.                                                                                                                                                                                                                                                                                |
| TK-017                                                                                                                                                                                            | Establish cross-team communication plan and project rituals.                                            | Done    | 2025-11-10: Authored rituals cadence doc, refreshed stakeholder map/communication channels in OWNERS, and aligned escalation path.                                                                                                                                                                                                                                                                                                |
| TK-018                                                                                                                                                                                            | Build core package bundler + TypeScript infrastructure (M1).                                            | Done    | Added tsup build config for `@react-gtm-kit/core` with ESM/CJS outputs and wired root scripts for workspace builds.                                                                                                                                                                                                                                                                                                               |
| TK-019                                                                                                                                                                                            | Implement core data layer manager with robust error handling (M1).                                      | Done    | Delivered `ensureDataLayer` utilities restoring previous globals and queue flush semantics in `packages/core/src/data-layer.ts`.                                                                                                                                                                                                                                                                                                  |
| TK-020                                                                                                                                                                                            | Deliver container loader and teardown orchestration (M1).                                               | Done    | Implemented script manager injecting/deduping multi-container scripts with teardown cleanup in `packages/core/src/script-manager.ts`.                                                                                                                                                                                                                                                                                             |
| TK-021                                                                                                                                                                                            | Provide logging, diagnostics, and developer warnings (M1).                                              | Done    | Introduced pluggable logger facade with safe fallbacks powering init/queue diagnostics in core client.                                                                                                                                                                                                                                                                                                                            |
| TK-022                                                                                                                                                                                            | Author alpha release notes and migration guidance (M1).                                                 | Done    | 2025-11-07: Authored `docs/releases/alpha.md` capturing alpha highlights, limitations, beta upgrade guidance, and feedback channels.                                                                                                                                                                                                                                                                                              |
| TK-023                                                                                                                                                                                            | Expand consent API typing and preset management (M2).                                                   | Done    | 2025-11-05: Added consent state utilities, validation, and presets with unit tests in `packages/core/src/consent/`.                                                                                                                                                                                                                                                                                                               |
| TK-024                                                                                                                                                                                            | Integrate consent events with loader lifecycle (M2).                                                    | Done    | 2025-11-05: Core client now exposes consent default/update APIs with data layer queuing tests for pre/post init behavior.                                                                                                                                                                                                                                                                                                         |
| TK-025                                                                                                                                                                                            | Document consent API adoption patterns for enterprise (M2).                                             | Done    | 2025-11-07: Authored `docs/how-to/enterprise-consent.md` covering CMP integration patterns, regional presets, troubleshooting, and monitoring guidance.                                                                                                                                                                                                                                                                           |
|                                                                                                                                                                                                   |
| TK-026                                                                                                                                                                                            | Implement SSR noscript helper utilities (M3).                                                           | Done    | 2025-11-05: Added `createNoscriptMarkup` helper with tests, exported defaults, and documented SSR usage in `docs/how-to/ssr.md`.                                                                                                                                                                                                                                                                                                  |
| TK-027                                                                                                                                                                                            | Add CSP nonce propagation across loaders (M3).                                                          | Done    | 2025-11-05: Core script manager now copies nonce + custom script attributes with unit coverage and SSR guide updates; follow-up E2E + adapter validation to land with platform packages.                                                                                                                                                                                                                                          |
| TK-028                                                                                                                                                                                            | Set up Playwright E2E harness for SSR + CSP flows (M3).                                                 | Done    | 2025-11-06: Added Playwright workspace, SSR CSP fixture server, CI workflow, and npm scripts for `pnpm e2e:test`.                                                                                                                                                                                                                                                                                                                 |
| TK-029                                                                                                                                                                                            | Develop React modern adapter with Suspense + StrictMode support (M4).                                   | Done    | 2025-11-07: Delivered `@react-gtm-kit/react-modern` package with provider + hooks, StrictMode remount handling, and Suspense-aware tests; lint + jest green.<br>Implement `packages/react-modern/src/provider.tsx` handling double-invocation safeguards;<br>Expose hooks for pushing events and updating consent;<br>Add Testing Library coverage for Suspense boundaries.                                                       |
| TK-030                                                                                                                                                                                            | Ship legacy React HOC and class component support (M4).                                                 | Done    | 2025-11-07: Added `@react-gtm-kit/react-legacy` package with StrictMode-safe `withGtm` HOC, unit tests, and migration guide in `docs/how-to/react-legacy-adapter.md`.                                                                                                                                                                                                                                                             |
| TK-031                                                                                                                                                                                            | Update sample applications showcasing adapters (M4).                                                    | Done    |

2025-11-07: Created Vite-based StrictMode and legacy adapter examples under `examples/` with README instructions plus dev/build scripts demonstrating consent + custom event pushes.
|
| TK-032 | Build Next.js App Router helpers with routing analytics (M5). | Done |
2025-11-07: Delivered `@react-gtm-kit/next` with route listener hook, Next head/noscript server helpers, and Jest coverage (route + server render).<br>Implement `packages/next/src/route-listener.ts` capturing route changes;<br>Expose server components for head scripts + noscript handling;<br>Add unit tests mocking Next.js router events.
|
| TK-033 | Create Next.js sample app with consent + CSP integration (M5). | Done | 2025-11-07: Shipped `examples/next-app/` App Router demo with consent banner, CSP nonce bridging, and typed navigation.<br>Includes README + styling + Suspense-wrapped GTM bridge. |
| TK-034 | Author Playwright E2E for Next.js navigations (M5). | Done | 2025-11-07: Added Next fixture launcher + Playwright spec for navigation + consent flows; awaiting successful browser install in CI (local download blocked).<br>2025-11-09: Hardened CSP + noscript assertions by checking rendered noscript markup and enforcing nonce propagation via JS property + attribute checks; local Playwright run in progress.<br>2025-11-09: Updated Playwright flows to decode consent cookies, stabilize nav selectors, and confirm CSP nonce propagation via fixture data attributes; e2e suite passing locally. |
| TK-035 | Launch documentation site with navigation and theming (M6). | Done | 2025-11-08: Bootstrapped VitePress docs site with navigation, README commands, and scripts for dev/build/preview. |
| TK-036 | Produce runnable example suite with automated smoke tests (M6). | Done | 2025-11-08: Added vanilla CSR example, aliased workspace packages for local builds, wired sequential smoke script + docs, and verified Next/Vite/server checks via `pnpm run examples:smoke`.<br>Build vanilla CSR, React SPA, Next App Router, and consent-focused demos;<br>Add npm scripts for installing + running each example;<br>Automate smoke tests via CI matrix. |
| TK-037 | Write concept/how-to docs with task-oriented structure (M6). | Done | 2025-11-08: Added Concepts section (architecture, consent lifecycle, SSR strategy) plus setup, migration, debugging, and analytics how-to guides with navigation updates. |
| TK-038 | Configure code coverage and quality gates in CI (M7). | Done | 2025-11-08: Added Jest coverage thresholds, CI workflow running lint/test/size with coverage uploads gated on Codecov token, and pnpm install prerequisites.<br>Enforce Jest coverage thresholds + generate reports;<br>Integrate Coveralls/codecov reporting;<br>Add failing gate if coverage regresses. |
| TK-039 | Implement bundle size monitoring and budgets (M7). | Done | 2025-11-08: Enforced gzip-focused Size Limit defaults, wired `pnpm run verify:lightweight` into CI, and published bundle optimization guide in docs. |
| TK-040 | Wire semantic-release with changelog automation (M7). | Done | 2025-11-08: Added semantic-release config spanning all packages, release/dry-run workflows, new release process doc, and changelog scaffold. |
| TK-041 | Establish observability and support readiness for post-launch. | Done | 2025-11-08: Added operability plan, support runbook, and nav updates covering alerting, on-call rotations, and community channels. |
| TK-042 | Plan marketing/devrel launch assets. | Done | 2025-11-07: Authored marketing launch plan, social copy, and conference abstract under `docs/marketing/`; added placeholder deck and navigation updates to surface materials. |
| TK-043 | Catalogue GTM tracking scenarios and acceptance criteria (M0). | Done | 2025-11-08: Authored `docs/design/tracking-matrix.md` outlining page view, conversion, ecommerce, lead, consent, and server relay scenarios with consent requirements, QA steps, and ownership; linked doc into VitePress nav and cross-referenced from examples guide for sign-off review. |
| TK-044 | Define event schema and TypeScript contracts (M1). | Done | 2025-11-07: Delivered typed event contracts + tsd coverage with new `events` module + reference docs. |
| |
| TK-045 | Implement lightweight event push helpers (M1). | Done | 2025-11-07: Added `pushEvent`/`pushEcommerce` utilities with tests, README snippet, and bundler exports. |
| |
| TK-046 | Build core event flow unit and integration tests (M1). | Done | Added Jest suite validating queue flush ordering, multi-container injection, and teardown cleanup for the core client. |
| TK-047 | Enforce zero-dependency and size budgets early (M1). | Done | 2025-11-07: Added `pnpm run verify:runtime-deps` script and `size-limit` budgets with `pnpm run size`; documented lightweight guardrails in `docs/governance/engineering-principles.md`. |
| TK-048 | Validate consent-aware event gating (M2). | Done | 2025-11-08: Prioritised consent defaults ahead of queued events with new unit tests, mocked CMP consent bridge in React adapter tests, and documented the interaction matrix in `docs/how-to/consent.md`. |
| TK-049 | Harden SSR data layer hydration (M3). | Done | 2025-11-07: Added dataLayer dedupe serialization, hydration-safe start event handling, unit coverage, and SSR hydration docs.<br>Implement utilities syncing server-rendered dataLayer state to client without duplication;<br>Add SSR unit tests ensuring noscript helper + hydration remain idempotent;<br>Capture guidance in `docs/how-to/ssr.md` with troubleshooting tips. |
| TK-050 | Expand React adapter coverage for routing and suspense (M4). | Done | 2025-11-08: Added React Router-driven pageview tracking to the StrictMode example, authored routing how-to docs, and introduced Testing Library coverage that proves navigation pushes fire once per route change. |
| TK-051 | Cover Next.js edge/runtime nuances (M5). | Done | 2025-11-08: Added Edge-safe nonce generator + consent cookie utilities, introduced middleware seeding defaults, updated App Router bridge to respect persisted consent, extended Playwright E2E to assert cookie transitions, and documented runtime behavior in Next example README. |
| TK-052 | Produce comprehensive tracking examples suite (M6). | Done | 2025-11-09: Landed Playwright snapshot harness powering `examples:smoke` with vanilla CSR, React StrictMode, fullstack relay, and Next App Router runs capturing page view, ecommerce, consent, and conversion pushes into `examples/.snapshots/*.json`. |
| TK-053 | Author troubleshooting and FAQ content for tracking scenarios (M6). | Done | 2025-11-08: Added troubleshooting guide covering duplicate containers, consent issues, navigation misses, and FAQ entries in `docs/how-to/troubleshooting.md` with smoke script references.<br>Linked the guide in VitePress navigation. |
| TK-054 | Finalize release-readiness checklist and dry run (M7). | Done | 2025-11-08: Created `docs/governance/release-checklist.md` outlining planning, code health, consent validation, documentation, release mechanics, and follow-up steps; surfaced it in docs sidebar. |
| TK-055 | Provide server-side GTM integration reference implementation. | Done | 2025-11-08: Added Node-based relay under `examples/server/` with forwarding logic + README guidance, and authored server integration how-to doc covering client host config, consent propagation, and deployment considerations. |
| TK-056 | Deliver companion web frontend implementation showcasing full-stack flow. | Done | 2025-11-09: Added `examples/fullstack-web/` with consent controls, relay configuration UI, purchase simulator, and data layer viewer; documented setup + linked from server integration guide.<br>Build a frontend example under `examples/fullstack-web/` that pairs with the server reference;<br>Demonstrate event capture, consent sync, and data layer pushes across client/server;<br>Document setup and usage in example README with pointers from main docs. |
| TK-057 | Automate Playwright browser provisioning for e2e runs. | Done | 2025-11-09: Added `pnpm e2e:install` script to install Chromium before tests and updated release documentation to reference the workflow. |
| TK-058 | Align docs with current core client API surface. | Done | 2025-11-09: Replaced legacy `initGtm`/`useGtmEvent` references with `createGtmClient`, `pushEvent(client, ...)`, and `useGtmPush` across quickstart, setup, debugging, consent, and analytics guides. |
| TK-059 | Restore Husky shim for workspace hooks. | Done | 2025-11-10: Reset `.husky/_/husky.sh` to the standard executable runner so pnpm/yarn/npx hook commands resolve correctly after the accidental deprecation stub.<br>2025-11-20: Reinstated the executable shim contents and re-sourced local hooks to ensure pnpm lint-staged and commitlint run under Husky.<br>2025-11-27: Recovered the shim after another regression to the deprecated stub and restored executable permissions. |
| TK-060 | Add GTM script load readiness signal and error surfacing through core + React/Next helpers. | Backlog | 2025-11-28: Design ScriptManager onload/onerror handling that resolves a readiness promise/callback, expose it on GtmClient, and thread through adapters so apps can gate event pushes and log failures.
| TK-061 | Add ScriptManager injection coverage for host/query/nonce/deduplication/teardown. | Backlog | 2025-11-28: Build focused unit tests that assert custom hosts, environment params, CSP nonces, duplicate detection, and teardown cleanup to harden script delivery paths.
| TK-062 | Ship maintenance & security operations. | Backlog | 2025-11-28: Configure Dependabot/Renovate for workspace packages with weekly triage and add SECURITY.md documenting contact email, SLA, and disclosure expectations. |
| TK-063 | Complete DPIA and consent evidence workflows. | Backlog | 2025-11-28: Author server integration DPIA notes and consent evidence retention steps; update governance docs with release checklist items for storing consent records and scheduling DPIA refreshes. |
| TK-064 | Lock in CMP integration for Consent Mode. | Backlog | 2025-11-28: Document CMP event-to-consent mapping with automated QA steps; add integration test (e.g., Playwright) simulating CMP callbacks ensuring queued and real-time consent commands reach the data layer in order. |
| TK-065 | Enforce quality gates in CI. | Backlog | 2025-11-28: Add CI jobs for pnpm test/lint/typecheck/size-limit/coverage thresholds and surface gate status in PR templates or badges. |
| TK-066 | Broaden task-based documentation. | Backlog | 2025-11-28: Add how-to guides for multi-container custom hosts, SSR noscript with CSP nonces, and GA4 ecommerce pushEcommerce; link them in docs navigation and README references. |
